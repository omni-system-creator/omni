# 金兰®综合信息管理系统功能需求规划方案

## 一、系统整体定位
为企业提供一体化的业务数据管理解决方案，实现合同、财务、项目、客户、供应商等核心业务流程的数字化管理与协同。系统采用**模块化松耦合设计**，各模块既可独立运行，又能通过标准接口实现数据深度互通。

## 二、核心功能模块规划

### 1. 合同全生命周期管理模块
**核心逻辑**：合同是业务的核心载体，向上关联客户/供应商（CRM），向下驱动项目（PM）与财务收付（Finance）。
**数据输入**：客户信息（CRM）、商品信息（Inventory）、审批结果（BPM）。
**数据输出**：应收/应付计划（Finance）、项目立项依据（PM）、出入库指令（Inventory）。

#### 1.1 合同创建与模板管理
- **基于历史合同快速生成标准模板**：支持从旧合同一键复制，自动清洗变量数据。
- **支持复杂格式模板**：内置富文本编辑器，支持多段排版、特殊签章位占位符、嵌套动态表格（如商品清单）。
- **模板版本管理与复用**：模板变更留痕，支持回滚至旧版本；支持公共模板与部门私有模板。
- **字段自定义配置**：提供可视化的表单设计器，支持拖拽配置字段（文本、日期、金额、关联引用等），适应不同业务场景。

#### 1.2 合同在线签署
- **移动端电子签章与手写签字**：集成第三方电子签章服务（或自建签章模块），支持手机/平板手写。
- **签章位置智能定位**：通过关键字（如“甲方盖章处”）自动定位盖章坐标。
- **签署流程可视化跟踪**：实时显示当前签署方（我方/对方）及状态（待签、拒签、已签）。
- **签署文件防篡改保护**：签署完成后自动生成 PDF 数字指纹（Hash），确保文件未被篡改。

#### 1.3 合同执行跟踪
- **关键节点自动提醒**：基于合同条款设定的日期（付款日、交付日、到期日），通过系统消息/邮件/短信自动提醒负责人。
- **执行进度可视化展示**：以时间轴或甘特图形式展示合同履行阶段。
- **变更记录全程留痕**：合同变更需走审批流程（BPM），保留变更前后的快照对比。
- **履约异常预警机制**：当实际进度/回款滞后于计划时，触发预警通知。

#### 1.4 合同归档与检索
- **自动归集合同及相关文件**：合同签署完成后自动归档，支持关联附件（补充协议、验收单、发票扫描件）。
- **全文检索**：基于 Elasticsearch 或类似技术，支持对合同内容、编号、客户名、备注进行毫秒级检索。
- **权限分级访问控制**：基于 RBAC 模型，细化到字段级的查看/下载/打印权限（如销售只能看自己的合同，财务可看金额）。
- **电子档案长期保存**：支持定期备份与冷存储，符合电子档案管理规范。

### 2. 项目管理模块
**核心逻辑**：项目是对合同履行的具体执行过程，消耗资源（人、财、物）并产出成果。
**数据输入**：合同信息（Contract）、预算指标（Finance）、团队成员（System）。
**数据输出**：进度报告（BI）、成本发生额（Finance）、验收文档（Contract）。

#### 2.1 项目统筹管理
- **多项目并行管理视图**：提供看板（Kanban）、列表、甘特图多视图切换，总览所有项目状态。
- **项目-合同-任务关联映射**：
  - 一个项目可对应多个合同（如总包+分包）。
  - 合同清单项自动转化为项目里程碑或任务。
- **资源分配与冲突检测**：为任务分配人员/设备，自动检测同一资源在同一时间段的占用冲突。
- **里程碑进度跟踪**：定义关键节点（如设计完成、首件交付），需上传佐证材料才可标记完成。

#### 2.2 项目文档协同
- **项目文档集中存储**：按项目结构自动创建文件夹树，统一存放设计图、方案、会议纪要。
- **版本控制与更新记录**：支持文件多版本共存，记录上传人、时间、备注，支持在线预览。
- **团队协作共享空间**：支持文档评论、@提及成员、即时通知。
- **外部客户文件交换区**：生成带有效期的外部分享链接，供客户上传/下载文件，无需登录系统。

#### 2.3 项目成本控制
- **预算与实际支出对比**：项目立项时设定预算（人工、差旅、采购），实时从财务模块获取实际支出进行对比。
- **成本超支预警**：当某项支出接近预算阈值（如80%）时，自动通知项目经理。
- **采购合同关联管理**：项目采购需求直接生成采购申请，关联至供应商合同。
- **工时与费用统计**：成员填报工时单（Timesheet），自动计算人力成本并计入项目总成本。

### 3. 财务管理模块
**核心逻辑**：作为业务数据的终点，负责资金流的核算与管控。
**数据输入**：合同收付款计划（Contract）、采购入库单（Inventory）、费用报销单（BPM）。
**数据输出**：财务凭证（对接外部ERP）、经营报表（BI）、付款状态更新（Contract）。

#### 3.1 应收应付管理
- **合同款项自动关联**：从合同模块自动读取分期收付款计划，生成应收/应付台账。
- **收付款计划自动生成**：支持按固定金额、比例、里程碑触发生成计划。
- **到账状态实时更新**：支持手动核销或对接银行流水自动核销（需银企直连）。
- **账龄分析与预警**：自动计算应收账款逾期天数，生成账龄分析表，辅助催收。

#### 3.2 发票管理
- **进项销项发票登记**：记录发票代码、号码、金额、税率等信息。
- **发票信息OCR识别**：上传发票图片/PDF，自动识别关键字段填入表单。
- **税票匹配与验真**：自动校验发票金额与合同/订单金额是否匹配；对接国税接口验真（需第三方服务）。
- **红冲作废流程管理**：发起发票红冲/作废申请，关联原发票记录，确保税务合规。

#### 3.3 财务报表
- **多维度收支统计报表**：按部门、项目、客户、时间维度统计现金流。
- **利润趋势分析图表**：自动计算毛利（收入-成本），展示月度/季度利润趋势。
- **部门/项目业绩报表**：自动生成各部门/项目的盈亏平衡表（P&L）。
- **自定义报表生成器**：拖拽数据源字段，配置过滤条件和聚合方式，生成个性化报表。

### 4. 客户与供应商管理模块 (CRM & SRM)
**核心逻辑**：提供统一的客商主数据，供其他模块调用，避免信息孤岛。
**数据输入**：销售线索（Web/Excel导入）、采购寻源。
**数据输出**：标准化的客户/供应商档案（供Contract、Finance使用）。

#### 4.1 客户360°视图
- **基础信息与资质管理**：工商信息、纳税人识别号、银行账户、营业执照附件。
- **多联系人关系图谱**：管理客户方的决策链（决策人、经办人、财务），标记关键联系人。
- **合作历史与信用评估**：自动聚合该客户的所有合同、回款记录、投诉记录，计算信用评分。
- **客户分级与标签体系**：根据贡献度自动划分等级（A/B/C），支持手动打标签（如“价格敏感”、“重点公关”）。

#### 4.2 供应商管理
- **供应商数据库建设**：分类管理（原材料、服务、外包），支持黑白名单机制。
- **履约能力评分系统**：基于交货准时率、质量合格率、价格优势进行自动打分。
- **采购价格对比分析**：记录同一商品不同供应商的历史报价，辅助比价。
- **合作风险预警**：对接外部征信数据（如天眼查），提示供应商法律诉讼、经营异常风险。

#### 4.3 销售过程管理
- **销售线索分配与跟进**：线索池公海管理，支持自动/手动分配，记录跟进日志。
- **报价单快速生成**：引用商品库信息生成标准报价单，支持导出 PDF。
- **商机转化率分析**：统计从线索->商机->合同的转化漏斗。
- **销售漏斗可视化**：展示各阶段（初步接洽、需求分析、方案报价、谈判签约）的商机数量与预计金额。

### 5. 商品与库存管理模块
**核心逻辑**：管理实物资产的流动。
**数据输入**：采购订单（Contract）、销售订单（Contract）。
**数据输出**：库存变动记录（Finance）、发货状态（Contract）。

#### 5.1 商品信息库
- **商品分类与属性管理**：多级分类树（如：电子产品/电脑/笔记本），支持继承父级属性。
- **规格参数标准化**：SKU 管理（颜色、尺寸、型号），统一编码规则。
- **价格体系维护**：支持多级价格（标准价、销售底价、大客户价、采购指导价）。
- **图片与文档附件**：关联商品主图、说明书、质检报告。

#### 5.2 库存跟踪
- **出入库记录管理**：基于采购入库单、销售出库单、领料单触发库存变动。
- **库存预警设置**：设置安全库存上下限，低于下限自动生成补货申请（推送至 BPM）。
- **批次与效期管理**：支持先进先出（FIFO），记录生产日期/有效期，临期预警。
- **盘点差异处理**：支持盲盘/明盘，生成盘盈盘亏单，经财务审批后调整库存。

### 6. 业务流程管理模块 (BPM)
**核心逻辑**：作为系统的“神经网络”，连接各业务模块，控制状态流转。
**数据输入**：各模块的审批请求（如合同审批、报销审批）。
**数据输出**：审批结果（通过/驳回/退回），更新业务单据状态。

#### 6.1 审批流程引擎
- **可视化流程设计器**：BPMN 2.0 标准，拖拽节点（开始、审批、抄送、分支、结束），配置连线条件。
- **多级审批节点配置**：支持会签（需全员同意）、或签（一人同意即可）、逐级审批。
- **审批人自动匹配**：按角色（如“部门经理”）、按指定人、按发起人上级自动寻找审批人。
- **流程时效监控**：设置节点超时时间，超时自动催办或转交。

#### 6.2 任务自动化
- **周期性任务自动调度**：类似 Cron Job，定时触发任务（如每月1号生成考勤报表）。
- **条件触发式工作流**：If-This-Then-That (IFTTT) 逻辑，例如“当合同金额>100万，自动发送邮件给CEO”。
- **邮件/消息自动通知**：集成站内信、邮件、钉钉/企微消息推送。
- **任务执行日志**：详细记录自动化任务的触发时间、执行结果、错误信息。

### 7. 数据可视化与决策支持模块 (BI)
**核心逻辑**：从各业务模块抽取数据（ETL），进行清洗、建模与展示。
**数据输入**：全系统业务数据。
**数据输出**：图表、报表、大屏。

#### 7.1 经营仪表盘
- **核心KPI实时展示**：总销售额、回款总额、库存周转率、人效比。
- **业务趋势图表分析**：同比/环比增长率分析。
- **异常数据突出显示**：红绿灯机制，展示高风险指标。
- **移动端数据看板**：适配手机屏幕的关键指标速览。

#### 7.2 销售分析
- **产品销量占比分析**：饼图/矩形树图展示爆款产品。
- **客户贡献度排名**：帕累托分析（20%客户贡献80%业绩）。
- **销售区域热力图**：基于地图展示各地区销售业绩。
- **季节性趋势预测**：基于历史数据预测未来销量趋势。

#### 7.3 财务分析
- **现金流健康状况评估**：经营性/投资性/筹资性现金流分析。
- **成本构成分析**：钻取成本结构（如：直接材料、直接人工、制造费用）。
- **盈利能力测算**：毛利率、净利率、ROE 等财务指标计算。
- **预算执行偏差分析**：仪表盘展示预算完成度及偏差原因。

### 8. 系统管理模块
**核心逻辑**：保障系统的安全、稳定运行，提供基础配置能力。

#### 8.1 组织与权限
- **多层级部门架构**：树形组织结构，支持一人多岗。
- **角色权限颗粒化配置**：功能权限（菜单/按钮）、数据权限（本人/本部门/全公司/特定数据）。
- **数据权限隔离**：支持多租户或逻辑隔离模式。
- **操作日志审计**：记录“谁、在什么时间、修改了什么数据、原值是什么、新值是什么”。

#### 8.2 系统配置
- **基础参数自定义**：系统名称、Logo、默认币种、时区设置。
- **编号规则设置**：自定义单据编号生成规则（如：HT-{YYYYMMDD}-{SEQ}）。
- **界面个性化调整**：主题色切换、布局模式选择。
- **菜单与功能定制**：支持低代码方式隐藏/显示菜单，修改字段显示名称。

#### 8.3 数据安全
- **本地化数据存储选项**：支持私有化部署时的本地文件存储路径配置。
- **自动与手动备份机制**：数据库定时全量/增量备份，支持一键恢复。
- **数据加密传输与存储**：全站 HTTPS，敏感字段（如密码、身份证号）AES 加密存储。
- **防CSRF攻击保护**：Token 验证机制，SQL 注入过滤。

#### 8.4 系统集成
- **标准API接口开放**：提供 RESTful API，Swagger 文档，支持 OAuth2 认证。
- **第三方系统对接**：预置主流系统适配器（如用友/金蝶财务凭证对接、钉钉/企微组织架构同步）。
- **数据导入导出工具**：支持 Excel 批量导入（带校验）、全模块数据导出。
- **单点登录支持**：支持 SAML 2.0、OIDC、CAS 协议 SSO。

## 三、技术特性需求

### 1. 系统架构
- **模块化设计**：采用 Monorepo 管理代码，支持功能按需打包。前端组件化，后端服务化。
- **支持云端、本地、混合部署**：容器化交付（Docker/Kubernetes）。
- **前后端分离**：Vue3 + Ant Design Vue (前端) / Spring Boot 或 Node.js (后端)。
- **微服务架构**：核心模块（如 Contract, BPM）可独立部署，通过 Feign/gRPC 调用。

### 2. 性能要求
- **支持百万级数据量处理**：数据库索引优化，读写分离，分库分表策略。
- **高并发场景下稳定运行**：Redis 缓存热点数据，消息队列（RabbitMQ/Kafka）削峰填谷。
- **页面响应时间≤3秒**：前端资源懒加载，CDN 加速，API 接口响应<500ms。
- **支持海量文件存储与检索**：对接 OSS/MinIO 对象存储。

### 3. 兼容性需求
- **支持主流浏览器**：Chrome, Edge, Firefox, Safari (最新2个版本)。
- **移动端适配**：响应式布局 + 独立 H5 应用。
- **支持Windows Server/Linux服务器环境**：跨平台运行。
- **与主流数据库兼容**：ORM 层适配 MySQL, PostgreSQL, Oracle, SQL Server。

### 4. 安全性要求
- **用户身份多重验证**：MFA (短信/OTP)。
- **操作权限精细控制**：基于 CASbin 或 Spring Security 的动态权限控制。
- **数据加密传输**：TLS 1.2+。
- **防SQL注入与XSS攻击**：全局过滤器与参数校验。

## 四、实施与部署方案

### 1. 部署方式选择
- **云端部署**：SaaS 模式，按年订阅，开箱即用。
- **本地部署**：私有化交付，一次性买断 + 维保服务。
- **混合部署**：核心数据本地存储，外网访问通过云端代理。

### 2. 版本策略
- **基础版**：包含 CRM + Contract (基础) + Finance (基础)，适合初创团队。
- **专业版**：增加 Project + Inventory + BPM，适合成长型企业。
- **企业版**：全功能 + BI + 定制开发接口，适合集团企业。

### 3. 实施支持
- **标准实施方法论**：需求调研 -> 蓝图设计 -> 系统配置 -> UAT -> 上线切换。
- **数据迁移工具与服务**：提供旧系统数据清洗与迁移脚本。
- **用户培训与知识库**：在线视频教程 + 帮助文档中心。
- **售后技术支持体系**：工单系统 + 专属客户经理。

## 五、预期效果指标

### 1. 效率提升
- **合同起草时间减少80%**：通过模板化和自动填充实现。
- **文件检索时间节省80%**：通过全文检索实现。
- **对账效率提升60%**：通过银企直连和自动核销实现。
- **审批流程缩短50%**：通过移动审批和超时催办实现。

### 2. 风险控制
- **合同遗漏率降低95%**：通过到期预警实现。
- **数据错误率减少90%**：通过系统自动计算和校验实现。
- **合规风险预警提前7天**：通过风险模型监控实现。
- **权限越权操作零发生**：通过严格的 RBAC 权限控制实现。

### 3. 成本节约
- **纸质合同成本减少100%**：全面推行电子签章。
- **人工统计工作量减少70%**：报表自动生成。
- **系统集成成本降低50%**：基于标准 API 对接。
- **培训成本减少60%**：界面直观，内置操作引导。

---

**金兰®综合信息管理系统**致力于为企业提供一体化、智能化、安全可靠的业务数据管理解决方案，通过数字化手段提升企业管理效率，降低运营风险，助力企业实现可持续发展。
